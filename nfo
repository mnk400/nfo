#!/bin/bash

# Created by Manik
# on Aug 6, 2020

function osname {
	os_t=$(uname -o)
	if [ $os_t == 'GNU/Linux' ]; then
		if [ -f /etc/os-release ]; then
			. /etc/os-release
			echo $NAME $VERSION_ID
		else
			echo "Can't read /etc/os-release"
		fi
	else
		echo "OS family not supported yet"
	fi
}

function total_mem {
	totalk=$(awk '/^MemTotal:/{print $2}' /proc/meminfo)
	var=1024
	echo $((totalk/var)) "MiB"
}

function cpu_info {
	lscpu | grep "Model name:" | sed -r 's/Model name:\s{1,}//g'
}

function wsl_check {
	if grep -q microsoft /proc/version; then
	echo "(WSL)"
	fi
}

function cur_shell {
	curs=$($SHELL --version)
	echo $curs | cut -d' ' -f1-2
}

function up_time {
	uptime -p | cut -d " " -f2- 
}

function totalpackages {
	dpkg-query -f '${binary:Package}\n' -W | wc -l
}

function screenres {
	timeout 2s bash -c "xdpyinfo | grep dimensions | sed -r 's/^[^0-9]*([0-9]+x[0-9]+).*$/\1/'" 
}

#Defining colours
RED='\033[0;31m'
MAGENTA='\033[0;35m'
GREEN='\033[0;32m'
YELLOW='\033[0;33m'
BLUE='\033[0;34m'
CYAN='\033[0;36m'
NC='\033[0m'

read -r -d '' name <<- EOM
• ▌ ▄ ·.  ▐ ▄ ▄ •▄
·██ ▐███▪•█▌▐██▌▄▌▪
▐█ ▌▐▌▐█·▐█▐▐▌▐▀▀▄·
██ ██▌▐█▌██▐█▌▐█.█▌
▀▀  █▪▀▀▀▀▀ █▪·▀  ▀
EOM

read -r -d '' file <<- EOM
.----.______
|nfo        |
|    ___________
|   /          /
|  /          /
| /          /
|/__________/
EOM

read -r -d '' nfo_isometric <<- EOM
⠀⠀⠀⠀___       ___       ___   
   /\__\     /\  \     /\  \  
  /:| _|_   /::\  \   /::\  \ 
 /::|/\__\ /::\:\__\ /:/\:\__\

 \/|::/  / \/\:\/__/ \:\/:/  /
   |:/  /     \/__/   \::/  / 
   \/__/               \/__/ 
EOM


read -r -d '' keyboard <<- EOM	
,----------------------------------------------------,
| [][][][][]  [][][][][]  [][][][]  [][__]  [][][][] |
|                                                    |
|  [][][][][][][][][][][][][][_]    [][][]  [][][][] |
|  [_][][][][][][][][][][][][][ |   [][][]  [][][][] |
| [][_][][][][][][][][][][][][]||     []    [][][][] |
| [__][][][][][][][][][][][][__]    [][][]  [][][]|| |
|   [__][________________][__]              [__][]|| |
\`----------------------------------------------------'
EOM


function print_out {
	printf "$nfo_isometric\n"
	echo $USER"@"$HOSTNAME
	echo -e "${RED}-${NC} ${MAGENTA}-${NC} ${YELLOW}-${NC} ${GREEN}-${NC} ${CYAN}-${NC} ${BLUE}-${NC} "
	echo "OS:		$(osname) $(wsl_check)"
	echo "Resolution: 	$(screenres)"
	echo "Uptime:		$(up_time)"
	echo "Shell:		$(cur_shell)"
	echo "Packages:	$(totalpackages)"
	echo "Memory:		$(total_mem)"
	echo "CPU:		$(cpu_info)"
}

print_out

